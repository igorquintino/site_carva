<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CARVA</title>
  <style>
    :root{ --bg:#ffffff; --fg:#0b0b0b; }
    html,body{height:100%}
    body{
      margin:0;
      background:#fff;
      color:var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* ====== Área do 3D ====== */
    .logo3d-wrap {
      position: relative;
      width: 100%;
      min-height: 100vh;
      overflow: hidden;
      background:#fff;
      isolation: isolate;
    }

    .logo3d-wrap::before{ content:none !important; }

    /* Canvas por cima (transparente) */
    .logo3d-wrap canvas{
      position:absolute;
      inset:0;
      z-index:1;
      display:block;
      width:100%; height:100%;
      background:transparent !important;
    }

    /* MOBILE (mantém branco) */
    @media (max-width: 640px){
      html, body { margin:0; background:#fff; }
      .logo3d-wrap{
        min-height: 100px;
        background:#fff;
      }
      .logo3d-wrap::before{ content:none !important; }
    }

    .hint{
      position:absolute; bottom:10px; left:50%;
      text-align:center;
      transform:translateX(-50%);
      color:#404040; font-size:12px; opacity:.75; z-index:2;
      font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif;
    }
    .msg{
      position:absolute; top:10px; left:50%;
      transform:translateX(-50%); font-size:12px;
      background:#141414; border:1px solid #2a2a2a;
      padding:.5em .8em; border-radius:10px; opacity:.9; max-width:92%;
      text-align:center; z-index:2; color:#fff;
    }

    .iconedireita{
      position: fixed; top:0; right:0; z-index:3; pointer-events:none;
    }
    .iconedireita img{ display:block; width:50vh; height:auto; margin:0; padding:0; }

    .iconeesquerda{
      position: fixed; bottom:0; left:0; z-index:3; pointer-events:none;
    }
    .iconeesquerda img{ display:block; width:50vh; height:auto; margin:0; padding-bottom:50px; }

    .iconeesquerdamobile img{ display:none }

    /* ===== MOBILE (<=640px) ===== */
    @media (max-width:640px){
      :root{ --icon-h: 250px; }

      .iconeesquerdamobile{
        position: fixed; top:0; left:0; z-index:10;
        margin:0; padding:0; pointer-events:none;
      }
      .iconeesquerdamobile img{
        display:block; height:var(--icon-h); width:auto; margin:0; padding:0;
      }

      .logo3d-wrap{
        position:relative;
        padding-top: calc(var(--icon-h) + 0px);
        height: calc(100dvh - var(--icon-h) - 8px);
        background:#fff; margin:0;
      }

      .logo3d-wrap canvas{
        position:absolute; top:0; left:50%;
        transform: translateX(-50%) scale(1);
        transform-origin: top center;
        z-index:1;
      }

      .iconedireita, .iconeesquerda { display:none; }
    }

    /* ====== (NOVO) Botão entre a logo e o texto ====== */
    .botao{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:68px;          /* fica acima do texto .hint */
      z-index:2;            /* acima do canvas (z=1) */
    }
    .botao button{
      background:transparent;
      border:2px solid #000;
      color:#000;
      border-radius:0;      /* quadrado */
      padding:10px 16px;
      font-size:14px;
      letter-spacing:.5px;
      cursor:pointer;
      transition:background .2s, color .2s;
    }
    .botao button:hover{
      background:#000;
      color:#fff;
    }

    @media (max-width:640px){
      .botao{ bottom:74px; }           /* ajusta distância no mobile */
      .botao button{
        padding:10px 14px;
        font-size:12px;
        border-width:2px;
      }
      .hint{ font-size:12px; bottom:14px; }
    }

    /* ===== DESKTOP (>=641px) ===== */
@media (min-width: 641px){

  /* 1) Logo 3D: maior e um pouco acima do meio */
  .logo3d-wrap{
    min-height:100vh;
  }
  .logo3d-wrap canvas{
    position:absolute;
    left:50%;
    top:38%;                          /* sobe a logo (meio seria 50%) */
    transform:translate(-50%, -50%) scale(1.35); /* aumenta a logo */
    transform-origin:center center;
  }

  /* 2) Botão: centralizado (já está), mas um pouco mais pra cima */
  .botao{
    left:50%;
    transform:translateX(-50%);
    bottom: 22vh;                     /* sobe o botão; ajuste se quiser */
    z-index:2;
  }

  /* 3) Frase: maior e um pouco mais alta */
  .hint{
    font-size:16px;                   /* maior (era 12px) */
    bottom: 8vh;                      /* sobe um pouco a frase */
  }
}

  </style>

  <script type="importmap">
    {"imports":{
      "three":"https://unpkg.com/three@0.160.0/build/three.module.js",
      "three/addons/":"https://unpkg.com/three@0.160.0/examples/jsm/"
    }}
  </script>
</head>
<body>
  <div class="iconedireita" id="iconedireita"><img src="testtedeiconedireita.png" alt=""></div>
  <div class="iconeesquerda" id="iconeesquerda"><img src="testedeicone.png" alt=""></div>
  <div class="iconeesquerdamobile" id="iconeesquerdamobile"><img src="testedeicone.png" alt=""></div>

  <div class="logo3d-wrap" id="logo3d">
    <div class="msg" id="msg" style="display:none"></div>

    <!-- (NOVO) Botão centralizado entre a logo 3D e o texto -->
    <div class="botao" id="botao">
      <button>ENTRAR NA LISTA DE ESPERA</button>
    </div>

    <div class="hint">Nada que nos empreda sobrevive</div>
  </div>

  <script type="module">
    const CONFIG = {
      modelUrl: './logo3dpreta.gltf',
      resourcePath: './',
      basePath: null,
      crossOrigin: 'anonymous',
      initialScale: 1.0,
      rotateOnIdle: true,
    };

    import * as THREE from 'three';
    import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
    import { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';

    const wrap = document.getElementById('logo3d');
    const msg  = document.getElementById('msg');
    function showMsg(text){ msg.innerHTML = text; msg.style.display = text ? 'block' : 'none'; }

    if (location.protocol === 'file:') {
      showMsg('Dica: rode com um servidor local (ex.: VS Code Live Server) para evitar bloqueios ao carregar .gltf e texturas.');
    }

    const scene = new THREE.Scene();
    scene.background = null;

    const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 100);
    camera.position.set(0, 0.2, 3.2);

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true });
    renderer.setClearColor(0x000000, 0);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    wrap.appendChild(renderer.domElement);

    const key = new THREE.DirectionalLight(0xffffff, 2.2); key.position.set(2, 3, 4);
    const fill = new THREE.DirectionalLight(0x99ffe1, 1.2); fill.position.set(-3, 2, 1);
    const rim = new THREE.DirectionalLight(0x66aaff, 1.1); rim.position.set(0, -2, -3);
    const amb = new THREE.AmbientLight(0xffffff, 0.35);
    scene.add(key, fill, rim, amb);

    const group = new THREE.Group();
    scene.add(group);

    const loader = new GLTFLoader();
    const draco = new DRACOLoader();
    draco.setDecoderPath('https://unpkg.com/three@0.160.0/examples/jsm/libs/draco/');
    loader.setDRACOLoader(draco);

    if (CONFIG.basePath) loader.setPath(CONFIG.basePath);
    if (CONFIG.resourcePath) loader.setResourcePath(CONFIG.resourcePath);
    if (CONFIG.crossOrigin) loader.crossOrigin = CONFIG.crossOrigin;

    function loadModel(){
      loader.load(
        CONFIG.modelUrl,
        (gltf)=>{
          const model = gltf.scene;
          const box = new THREE.Box3().setFromObject(model);
          const size = box.getSize(new THREE.Vector3()).length();
          const scale = (CONFIG.initialScale * 1) / (size || 1);
          model.scale.setScalar(scale);

          model.traverse((o)=>{
            if(o.isMesh){
              o.castShadow = o.receiveShadow = true;
              if(o.material) o.material.envMapIntensity = 1.0;
            }
          });
          model.rotation.set(0, Math.PI*0.1, 0);
          group.add(model);
          showMsg('');
        },
        undefined,
        (err)=>{
          console.error('Erro ao carregar GLTF:', err);
          showMsg('Não consegui carregar seu <b>.gltf</b>. Verifique:<br>• <b>resourcePath</b> aponta para a pasta com <b>.bin</b> e <b>textures/</b><br>• Rode via servidor local (http://).<br>Carregando um cubo de teste...');
          const geo = new THREE.BoxGeometry(1,1,1);
          const mat = new THREE.MeshStandardMaterial({ color: 0x18e091, metalness:.4, roughness:.35 });
          const cube = new THREE.Mesh(geo, mat);
          group.add(cube);
        }
      );
    }
    loadModel();

    function resize(){
      const w = wrap.clientWidth, h = wrap.clientHeight;
      renderer.setSize(w, h, false);
      camera.aspect = w / h; camera.updateProjectionMatrix();
    }
    resize();
    addEventListener('resize', resize);

    // Interação arrastar + inércia
    let isDown = false, lastX = 0, lastY = 0, vx = 0, vy = 0;
    const onDown = (x,y)=>{ isDown = true; lastX = x; lastY = y; };
    const onMove = (x,y)=>{
      if(!isDown) return;
      const dx = x - lastX, dy = y - lastY; lastX = x; lastY = y;
      const k = 0.005;
      vy = -dx * k; vx = -dy * k;
      group.rotation.y += vy; group.rotation.x += vx;
      group.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, group.rotation.x));
    };
    const onUp = ()=>{ isDown = false; };
    renderer.domElement.addEventListener('mousedown', e=> onDown(e.clientX, e.clientY));
    addEventListener('mousemove', e=> onMove(e.clientX, e.clientY));
    addEventListener('mouseup', onUp);

    renderer.domElement.addEventListener('touchstart', e=>{
      const t=e.touches[0]; if(t) onDown(t.clientX, t.clientY);
    }, {passive:true});
    renderer.domElement.addEventListener('touchmove',  e=>{
      const t=e.touches[0]; if(t) onMove(t.clientX, t.clientY);
    }, {passive:true});
    renderer.domElement.addEventListener('touchend', onUp);

    const clock = new THREE.Clock();
    function tick(){
      const dt = Math.min(clock.getDelta(), 0.032);
      if(!isDown){
        group.rotation.y += vy; group.rotation.x += vx;
        vy *= 0.94; vx *= 0.94;
        if(CONFIG.rotateOnIdle && Math.abs(vx)+Math.abs(vy) < 0.0006){ group.rotation.y += 0.003; }
      }
      renderer.render(scene, camera);
      requestAnimationFrame(tick);
    }
    tick();
  </script>
</body>
</html>
